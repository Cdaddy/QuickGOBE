#!/bin/bash

VALID_USERS=("uni_qgo");
REPOS_DIR="../../repos"
QUICKGO_DIR="unp.goa.quickgo"

if [ -z "$1" ] || [ "$1" == "submit" ]; then
   echo "No server type was input [dev]";
   exit 1;
else
   solr_server=$1;
fi

# read common environment variables
properties_not_found="false";

source "../common/common.variables";
if [ $? -eq 1 ]; then
    properties_not_found="true";
fi

if [ "$properties_not_found" = "true" ]; then
    echo "Required properties files were not found. Please make sure you're in the right directory";
    exit 1;
fi

if [ ! -d "$QUICKGO_SERVICE_DIR" ]; then
    mkdir --parents "$QUICKGO_SERVICE_DIR"
fi

current_dir=$(pwd)

cd "$REPOS_DIR/$QUICKGO_DIR"

git fetch
git checkout GOA-1793_GO_code_reshuffle
git pull
mvn -U -DskipTests -P indexing package

mv indexing/target/*.jar $QUICKGO_SERVICE_DIR

cd $current_dir
